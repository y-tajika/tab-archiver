# TODO

## このドキュメントについて

### 目的
このドキュメントは、プロジェクトの現在の状態と今後の方向性を明確にするための引き継ぎ資料です。直近のコードレビュー結果と、次に実装すべき機能の優先順位を記載します。

### 対象読者
- プロジェクトを引き継ぐ開発者
- 次のバージョンで何を実装すべきか判断する開発者

### このドキュメントに記載すること
- 現在のバージョンの状態（完了/作業中）
- 直近のコードレビュー結果と評価
- 次期バージョン候補（優先度付き）
- 実装しないと判断した項目とその理由

### このドキュメントに記載しないこと
- 実装済み機能の詳細（DEVELOPMENT_LOG.md参照）
- 過去の変更履歴（CHANGELOG.md参照）

---

## 現在の状況

> **注:** バージョン番号・ショートカットキーなどの設定は `src/manifest.json` を参照

**状態**: v2.2.0 リリース済み（フォルダ選択UI改善）

**最新のコードレビュー結果**: DEVELOPMENT_LOG.md を参照

---

## 改善候補

### 全ウィンドウ対応 - 優先度: 🟡 中（次回マイナーバージョン候補）

**背景:** 現在は現在のウィンドウのタブのみ保存。別ウィンドウで開いているタブも一緒に保存したいケースがある

- [ ] **全ウィンドウのタブを保存**
  - 現状: `chrome.tabs.query({ currentWindow: true })` で現在のウィンドウのみ
  - 実装案1: 全タブを1つのフォルダに保存
    - `chrome.tabs.query({})` で全ウィンドウのタブ取得
    - フォルダ名は現在と同じ形式
    - 設定: `src/options.js` に「全ウィンドウを保存」チェックボックス追加
  - 実装案2: ウィンドウごとにサブフォルダ作成（推奨）
    - `chrome.windows.getAll({ populate: true })` で全ウィンドウ取得
    - メインフォルダ: `MM-DD_要約` → サブフォルダ: `ウィンドウ1`, `ウィンドウ2`, ...
    - より整理された構造
  - ファイル: `src/background.js` の `saveAllTabs()`, `src/options.js`, `src/options.html`
  - 工数: 中（3-5時間）
  - UI考慮: ラジオボタンで選択
    - ○ 現在のウィンドウのみ（デフォルト）
    - ○ 全ウィンドウ（1つのフォルダ）
    - ○ 全ウィンドウ（ウィンドウごとにサブフォルダ）
  - 技術的考慮: ウィンドウ数が多い場合のパフォーマンス

---

### 追加機能候補 - 優先度: 🟢 低

#### タブフィルタリング

- [ ] **除外ドメイン設定**
  - 実装: `src/options.js` に除外ドメインリスト追加（配列管理）
  - UI: 入力欄 + 削除ボタン付きリスト表示
  - ファイル: `src/background.js` の `saveAllTabs()` でドメインチェック追加
  - 工数: 中（3-4時間）

- [ ] **ピン留めタブ除外オプション**
  - 実装: settings に `excludePinnedTabs` 追加
  - ファイル: `src/background.js` の `tabs.query()` で pinned プロパティをフィルタ
  - 工数: 小（1時間）

#### フォルダ名テンプレート

- [ ] **カスタムフォルダ名形式**
  - 実装: プレースホルダー置換システム
  - 対応変数: `{date}`, `{time}`, `{summary}`, `{count}`
  - UI: `src/options.js` にテンプレート入力欄 + プレビュー表示
  - 例: `[{date}] {summary} ({count}タブ)` → `[MM-DD] GitHub_開発 (8タブ)`
  - 工数: 大（6-8時間）
  - 技術的考慮: 不正な形式の検証、デフォルトへのフォールバック

#### 保存履歴

**背景:** 過去に保存したフォルダを再度開きたいケースがある

- [ ] 最近保存したフォルダ表示
  - ファイル: src/popup.html
  - 実装: chrome.storage.local に履歴保存（最大10件、FIFO）
  - UI: popup.htmlに履歴セクション追加
  - クリック: chrome.bookmarks.get() → 新しいタブで開く
  - 工数: 中（4-5時間）
  - 技術的考慮: フォルダ削除時のエラーハンドリング

#### タブグループ対応

**背景:** Chrome 88+でタブグループ機能が追加された

- [ ] グループごとにサブフォルダ作成
  - 実装: chrome.tabGroups API 使用
  - グループ情報取得 → グループ名でサブフォルダ作成
  - 工数: 大（8-10時間）
  - 技術的考慮: 
    - グループ未対応ブラウザ（Edge古いバージョン）の互換性
    - グループ化されていないタブの扱い（ルートに配置 or "未分類"フォルダ）
    - src/manifest.json に tabGroups パーミッション追加必要

**判断:** 現状で十分なら実装不要。ユーザーからの要望次第で判断。

---

## 実装しない項目

### テスト
- 単体テストの追加
  - 理由: 小規模プロジェクト、手動テストで十分
  - 再検討時期: 機能が10個以上になった場合

### リファクタリング
- DEFAULT_SETTINGS の共通モジュール化
  - 理由: Manifest V3 の Service Worker 制約で困難
  - 現状: background.js と options.js で重複（許容）
  - 代替策なし

---

**最終更新**: 2026-01-15
